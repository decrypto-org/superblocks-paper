\section{Introdution}

Bitcoin~\cite{bitcoin} and other blockchains which use the same backbone
consensus mechanism~\cite{EC:GarKiaLeo15} use Simple Payment Verification (SPV)
clients to shorten the synchronization time for lightweight clients. Recently, a
line of work has introduced \emph{superlight} clients, which do not require all
blockchain headers to be downloaded, but, rather, only a sample of them. This
sample consists of blocks which happen to achieve a higher difficulty than the
required one, and are thus termed \emph{superblocks}.

By sampling the superblocks of a chain, short proofs about a blockchain can be
created, which allow a client to synchronize with the longest blockchain without
downloading all blocks. These so-called \emph{proofs of proof-of-work} contain
only a small number of cleverly chosen superblocks which compact the
proof-of-work of the blockchain into a succinct string, while maintaining the
same security level as SPV clients. However, while the existence of superblocks
has been theoretically posed and the protocol has even been deployed in
practice, the distribution of superblocks within a blockchain has not been
measured. In this paper, we provide measurements of this distribution for the
Bitcoin blockchain.

In order for superblock sampling to work, it is necessary that each block
contains, in addition to the standard pointer to its previous block, a few
pointers to some preceding superblocks. These pointers are organized in a
special data structure, the \emph{interlink}. For relevant applications such as
superlite clients and cross-chain transfers, it is critical that the interlink
structure is compact. We measure the size of the interlink structure and provide
a novel but simple optimization which can bring down its size to a half. We then
study the impact of this improvement on the size of proofs of proofs-of-work.

\noindent
\textbf{Related work.}
Superblocks were first observed to exist in~\cite{highway}.
The interlink data structure was put forth in~\cite{popow}, where it was also
observed that it can be organized into a Merkle tree. Interlinks containing more
blocks than just superblocks or even all blocks have been
proposed in~\cite{vitalik-eip,flyclient} \TODO{TODO citations}. Interlinks have
been included from genesis in several cryptocurrencies such as ERGO, nimiq, and
WebDollar \TODO{TODO citations}. In~\cite{nipopows}, the consumption of the
interlink data to construct Non-Interactive Proofs of Proofs-of-Work was
presented and concrete numbers were given about the sizes of such proofs. They
also presented a way to construct such a structure without a soft or hard fork,
but a velvet fork, which was later explored in~\cite{velvet}. Bitcoin Cash has
been velvet forked in this manner~\cite{gtklocker}. One
application of NIPoPoWs is cross-chain transfers~\cite{pow-sidechains}
\TODO{TODO citation} with a proof-of-work blockchain source. Comparable
constructions have also appeared for proof-of-stake
blockchains~\cite{pos-sidechains} \TODO{replace citation with Oakland}.

\noindent
\textbf{Our contributions.} The contributions of this paper are summarized as
follows:

\begin{enumerate}
  \item We measure superblock distributions for Bitcoin, Bitcoin Cash, Ethereum
        and Monero. We show that the distribution of superblocks follows
        expectation, indicating there are no ongoing or historical attacks of
        \emph{badness}. We are the first to collect any empirical measurements
        of superblocks on real blockchains.
  \item We put forth the simple but important optimization in regards to the way
        blocks are compactly stored in an interlink tree by observing that
        duplicate pointers can be removed without harming security. As such, we
        construct interlink \emph{block sets} instead of interlink \emph{block
        lists}. To our knowledge, no implementation currently does this, but all
        existing implementations could benefit by applying this modification.
  \item We prove that our optimization reduces the number of pointers in each
        interlink by a half on average.
  \item We implement our improvement on the Bitcoin Cash blockchain and collect
        empirical data regarding the performance of our improvement, including
        concrete sizes of NIPoPoWs built. We experimentally demonstrate that our
        optimizaiton reduces the already very succinct NIPoPoW certificates by
        $6.6\%$.
\end{enumerate}
